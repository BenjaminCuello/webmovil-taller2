# Taller 2 - IntroducciÃ³n al Desarrollo Web MÃ³vil  

---

## Grupo 1 â€” Equipo: SmartCoders

### Integrantes
- Bastian Salinas â€” 21.848.994-K  
- BenjamÃ­n Cuello â€” 21.682.135-1  
- BenjamÃ­n Salas â€” 21.758.667-4  
- TomÃ¡s Guerra â€” 21.664.344-5  

---

##  DescripciÃ³n General

InfoMÃ³vil ahora integra un ecosistema con **3 servicios backend propios** y un **frontend mÃ³vil empaquetado como aplicaciÃ³n Android (APK)** usando **Apache Cordova**.  

La app mantiene las mismas funcionalidades del Taller 1 (PokÃ©mon, paÃ­ses, clima y feriados), pero ahora **todos los datos provienen de nuestras propias APIs y bases de datos**.

---

##  Objetivos del Proyecto
- Desarrollar **3 APIs independientes**, cada una en una tecnologÃ­a distinta.  
- Crear un **frontend mÃ³vil responsivo** que consuma dichas APIs.  
- **Empaquetar la app como APK Android** funcional.  
- Mantener el mismo diseÃ±o, navegaciÃ³n y estructura modular del Taller 1.  

---

## ðŸ§© Arquitectura del Sistema
```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend (Cordova App) â”‚  â† HTML + JS + Tailwind
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚        â”‚         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚NestJS â”‚ â”‚Expressâ”‚ â”‚ FastAPI  â”‚
â”‚/pokemonâ”‚â”‚/countriesâ”‚â”‚/weather+holidaysâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚         â”‚         â”‚
 PostgreSQL  PostgreSQL MongoDB
```

---

## APIs a usar: 

### API 1 â€” PokÃ©mon (NestJS + PostgreSQL)
- **Endpoints**
  - `GET /pokemon?limit&offset` â†’ lista de pokemones  
  - `GET /pokemon/:nombreOId` â†’ detalle de un pokemon  
- **Datos almacenados:** id, nombre, sprites, tipos, altura, peso, estadÃ­sticas.  
- **Puerto:** `http://localhost:3000`  

---

### API 2 â€” PaÃ­ses (Express + PostgreSQL)
- **Endpoints**
  - `GET /countries` â†’ lista de todos los paÃ­ses  
  - `GET /countries/search?name=Chile` â†’ bÃºsqueda por nombre  
- **Datos:** nombre comÃºn, oficial, bandera, regiÃ³n, capital, poblaciÃ³n, cÃ³digo ISO.  
- **Puerto:** `http://localhost:4000`  

---

###  API 3 â€” Clima y Feriados (FastAPI + MongoDB)
- **Endpoints**
  - `GET /weather?city=La%20Serena` â†’ devuelve temperatura y viento actuales  
  - `GET /holidays/{countryCode}/{year}` â†’ devuelve feriados del paÃ­s y aÃ±o indicado  
- **Datos:**  
  - Clima â†’ nombre, latitud, longitud, temperatura, viento.  
  - Feriados â†’ fecha, nombre local y nombre oficial.  
- **Puerto:** `http://localhost:8000`  

---

##  Frontend (Cordova + HTML + JS + Tailwind)
- CÃ³digo fuente ubicado en `frontend/www/`, estructurado para reutilizarse dentro de Cordova (`www/`).  
- Mantiene el diseÃ±o y la lÃ³gica del Taller 1, ahora parametrizado para consumir nuestras APIs o datos mock.  
- **ConfiguraciÃ³n:** `frontend/www/js/config.js` define el modo y las URLs base:
  ```js
  var MODE = 'public' // 'public' | 'local' | 'mock'
  var BASE_URL_POKEMON = 'http://localhost:3000'
  var BASE_URL_COUNTRIES = 'http://localhost:4000'
  var BASE_URL_FASTAPI = 'http://localhost:8000'
  ```
- El encabezado muestra y permite cambiar el modo de datos (APIs pÃºblicas/locales/mocks), recordando la Ãºltima selecciÃ³n.
- Consulta `frontend/README.md` para instrucciones especÃ­ficas (Docker, servidores estÃ¡ticos, Cordova).
- Consulta `docs/frontend-testing-checklist.md` para validar cada modo antes de entregar.
- Consulta `docs/backend-contracts.md` para implementar las APIs con el contrato correcto.
- Puedes sincronizar el `www/` hacia Cordova con `npm run sync-www -- --target ../infomovil-app/www`.
- El modo se puede cambiar tambiÃ©n vÃ­a `?mode=mock` o `?mode=local` en la URL, Ãºtil para demos.
- Requiere Node.js >= 16 para ejecutar los scripts opcionales (`npm run sync-www`).
- Los datos de ejemplo para `MODE='mock'` estÃ¡n en `frontend/www/mock/`.

---

## TecnologÃ­as a utilizar: 

### Frontend
- HTML5  
- CSS3 + Tailwind CSS (CDN)  
- JavaScript ES6  
- Apache Cordova

### Backend
- NestJS (TypeScript) + PostgreSQL  
- Express (Node.js) + PostgreSQL  
- FastAPI (Python) + MongoDB

---

##  Estructura del Repositorio de momento
```text
infomovil-taller2/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ express/
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â”œâ”€â”€ fastapi/
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â”œâ”€â”€ nest/
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ README.md
â”‚   â””â”€â”€ www/
â”‚       â”œâ”€â”€ index.html
â”‚       â”œâ”€â”€ styles.css
â”‚       â”œâ”€â”€ js/
â”‚       â”‚   â”œâ”€â”€ api.js
â”‚       â”‚   â”œâ”€â”€ config.js
â”‚       â”‚   â”œâ”€â”€ config.sample.js
â”‚       â”‚   â”œâ”€â”€ countries.js
â”‚       â”‚   â”œâ”€â”€ holidays.js
â”‚       â”‚   â”œâ”€â”€ main.js
â”‚       â”‚   â”œâ”€â”€ pokemon.js
â”‚       â”‚   â”œâ”€â”€ ui.js
â”‚       â”‚   â”œâ”€â”€ utils.js
â”‚       â”‚   â””â”€â”€ weather.js
â”‚       â””â”€â”€ mock/
â”‚           â”œâ”€â”€ countries_all.json
â”‚           â”œâ”€â”€ holidays_CL_2025.json
â”‚           â”œâ”€â”€ pokemon/
â”‚           â”‚   â”œâ”€â”€ bulbasaur.json
â”‚           â”‚   â”œâ”€â”€ charizard.json
â”‚           â”‚   â”œâ”€â”€ charmander.json
â”‚           â”‚   â”œâ”€â”€ gengar.json
â”‚           â”‚   â”œâ”€â”€ ivysaur.json
â”‚           â”‚   â”œâ”€â”€ mew.json
â”‚           â”‚   â”œâ”€â”€ squirtle.json
â”‚           â”‚   â”œâ”€â”€ pikachu.json
â”‚           â”‚   â””â”€â”€ snorlax.json
â”‚           â”‚   â””â”€â”€ venusaur.json
â”‚           â”œâ”€â”€ pokemon_list.json
â”‚           â”œâ”€â”€ weather_Calama.json
â”‚           â”œâ”€â”€ weather_La_Serena.json
â”‚           â”œâ”€â”€ weather_Santiago.json
â”‚           â””â”€â”€ weather_default.json
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ sync-www.js
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ backend-contracts.md
â”‚   â””â”€â”€ frontend-testing-checklist.md
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

### Backend (pendiente por equipos)

- Cada servicio tiene su carpeta dentro de `backend/` con un `Dockerfile` placeholder y documentaciÃ³n en `backend/README.md`.
- Al implementar las APIs se debe actualizar ese `Dockerfile` y aÃ±adir la configuraciÃ³n de la base de datos correspondiente.
- Los contenedores exponen puertos `3000`, `4000` y `8000`, que tambiÃ©n se publican en el host.

---
## OrganizaciÃ³n

DivisiÃ³n de tareas y organizaciÃ³n:  https://docs.google.com/spreadsheets/d/1SS0sQna__lw2i_N7hFHYkcZuJKCjdoBD3aPRTeOkSSM/edit?gid=0#gid=0 


<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/0925bbb5-e158-4a53-a7a7-44f48cb05083" />

**Proyecto desarrollado para el curso IntroducciÃ³n al Desarrollo Web MÃ³vil - Universidad CatÃ³lica del Norte (UCN) 2025**

---

## EjecuciÃ³n por modos (Frontend)

- `public` (por defecto): usa las APIs pÃºblicas del Taller 1. No requiere backends locales.
- `local`: usa las 3 APIs propias (NestJS/Express/FastAPI). Configurar `BASE_URL_*` en `frontend/www/js/config.js`.
- `mock`: usa datos locales de `frontend/www/mock/` sin depender de Internet ni de backends.

CÃ³mo cambiar de modo:
- Usa el selector del encabezado (badge) para cambiar entre `mock`, `public` y `local`.
- TambiÃ©n puedes usar el query param temporal: `?mode=mock` (sobrescribe por sesiÃ³n actual).
- Cuando los backends estÃ©n listos, recuerda volver a `MODE = 'local'` (o `?mode=local`) para probarlos.

Notas de red:
- En emulador Android: usar `http://10.0.2.2:<puerto>` como host para `BASE_URL_*`.
- En Docker: `http://host.docker.internal:<puerto>` (Windows/macOS). En Linux, usar IP del host (p. ej. `172.17.0.1`).

---

## Contratos de API esperados (para backends)

Estos contratos replican lo que consume el frontend (idÃ©ntico a las APIs pÃºblicas):

- PokÃ©mon (NestJS)
  - `GET /pokemon?limit=&offset=` â†’ `{ count?: number, results: [{ name, url? }] }`
  - `GET /pokemon/:idOrName` â†’ objeto con al menos: `id, name, sprites.{front_default,back_default,other['official-artwork'].front_default}, types[{type:{name}}], height, weight, stats[{base_stat, stat:{name}}]`.

- PaÃ­ses (Express)
  - `GET /countries` â†’ array de paÃ­ses con: `name.{common,official}, flags.{png|svg}, region, capital[], population, cca2`.
  - `GET /countries/search?name=Chile` â†’ array de coincidencias (mismo shape) filtrado por nombre.

- FastAPI (Clima y Feriados)
  - `GET /weather?city=La%20Serena` â†’ `{ coordenadas: { name, country_code, latitude, longitude }, clima: { current: { temperature_2m, wind_speed_10m } } }`.
  - `GET /holidays/{countryCode}/{year}` â†’ array de `{ date: 'YYYY-MM-DD', localName: string, name: string }`.

Ejemplos JSON estÃ¡n disponibles en `frontend/www/mock/` para referencia rÃ¡pida.

---

## Docker / Docker Compose

Para levantar todo el ecosistema (frontend + contenedores placeholder de backend):

```bash
docker-compose up --build
```

- Frontend disponible en `http://localhost:8080` (Nginx sirviendo `frontend/www`).
- Los servicios `nest`, `express` y `fastapi` exponen `3000`, `4000` y `8000` respectivamente. Actualmente ejecutan un placeholder hasta que cada equipo agregue su cÃ³digo.
- Cuando los backends estÃ©n listos, reemplazar los `Dockerfile` de cada carpeta y `docker-compose` los buildarÃ¡ automÃ¡ticamente.
- Para que el frontend consuma estos servicios una vez implementados, configurar `MODE = 'local'` y las URLs en `frontend/www/js/config.js` (`http://localhost:puerto` ya coincide con el mapeo de Compose).

> Nota: si solo necesitas el frontend (por ejemplo, mientras tus compaÃ±eros avanzan con el backend) ejecuta:
>
> ```bash
> docker-compose up --build frontend --no-deps
> ```
>
> `--no-deps` evita levantar los servicios de backend y previene conflictos con otros proyectos que usen los puertos 3000/4000/8000 en tu host.

ConstrucciÃ³n manual solo del frontend (opcional):

```bash
docker build -t infomovil-frontend -f frontend/Dockerfile frontend
docker run --rm -p 8080:80 infomovil-frontend
```

Si accedes al frontend desde Docker y los backends corren en host (fuera de Compose), usar `host.docker.internal` en `BASE_URL_*` (Windows/macOS) o la IP del host (`172.17.0.1` en muchas instalaciones Linux).

---

## Cordova (APK)

GuÃ­a de empaquetado (realizar cuando los backends estÃ©n listos o usando `MODE=mock`):

1) Instalar Cordova y Android SDK (Java JDK, Android Studio, variables `ANDROID_HOME`).
2) Crear app Cordova nueva (usa un nombre diferente al directorio `frontend/` del repositorio):
```bash
cordova create infomovil-app com.infomovil.app InfoMovil
cd infomovil-app
cordova plugin add cordova-plugin-whitelist
cordova platform add android
# Copia el contenido de frontend/www/ del repositorio a infomovil-app/www/
# (Ejemplo con rsync; en Windows se puede copiar manualmente la carpeta)
rsync -av --delete ../webmovil-taller2/frontend/www/ www/
cordova build android
```
3) APK generado: `infomovil-app/platforms/android/app/build/outputs/apk/debug/`.

Whitelist/CSP:
- AÃ±adir `<allow-navigation href="*" />` y `<access origin="*" />` en `config.xml` para desarrollo.
- Mantener `Tailwind` via CDN o incluir build local si se desea offline.

Red en emulador/dispositivo:
- Emulador: `10.0.2.2` para alcanzar `localhost` del PC.
- Dispositivo real: usar la IP local del PC y abrir puertos de los backends.

Consulta `frontend/README.md` para un checklist previo a la generaciÃ³n del APK y notas sobre integraciÃ³n con backend (CORS, URLs, mocks).
