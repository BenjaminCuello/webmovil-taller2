# API de Clima y Feriados (FastAPI)

## 1) Nombre y propósito

Entrega datos de clima y feriados para el frontend del Taller 2. Replica lo mínimo usado en el Taller 1: clima actual por ciudad y feriados por país/año. No consume APIs externas en tiempo de ejecución; responde desde una base MongoDB poblada con seeds locales.

## 2) Tecnología usada

- FastAPI (Python)
- MongoDB (Atlas)
- Docker Compose (si corresponde)

## 3) Cómo ejecutarla

### Opción A — Docker Compose (recomendada)

Ejecutar desde la raíz del repositorio:

```cmd
docker compose up --build
```

Disponible en `http://localhost:8000`.

### Opción B — Local (sin Docker)

```cmd
cd backend\fastapi
pip install -r requirements.txt
set MONGODB_URI=mongodb+srv://<usuario>:<password>@<cluster>/<params>
uvicorn main:app --reload
```

Sirve en `http://127.0.0.1:8000`.

## 4) Endpoints disponibles

- `GET /weather?city=<nombre>` → clima actual para la ciudad
- `GET /holidays/{countrycode}/{year}` → feriados por país/año

## 5) Ejemplos de respuesta

`GET /weather?city=Valparaíso`:

```json
{
  "coordenadas": {
    "name": "Valparaíso",
    "country_code": "CL",
    "latitude": -33.036,
    "longitude": -71.62963
  },
  "clima": {
    "current": {
      "temperature_2m": 14.3,
      "wind_speed_10m": 8.4
    }
  }
}
```

`GET /holidays/CL/2025`:

```json
[
  { "date": "2025-01-01", "localName": "Año Nuevo", "name": "Año Nuevo" },
  {
    "date": "2025-09-19",
    "localName": "Día de las Glorias del Ejército",
    "name": "Día de las Glorias del Ejército"
  }
]
```

## 6) Notas sobre la base de datos

- Origen de datos: `weather-seed.json` y `holidays-seed.json` en este directorio.
- Inicialización: en `startup` se cargan los seeds si hay pocos registros (clima < 30; feriados < 5).
- Base y colecciones: BD `infomovil`; colecciones `weather_data` y `holidays_data`.
- Conexión: variable `MONGODB_URI` (si falta, se usa un valor por defecto definido en `main.py`).
